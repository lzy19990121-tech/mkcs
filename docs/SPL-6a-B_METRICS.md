# SPL-6a-B: æ¼‚ç§»æŒ‡æ ‡å®ç° - å®ŒæˆæŠ¥å‘Š

**å®Œæˆæ—¥æœŸ**: 2026-02-01
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## ğŸ“‹ ä»»åŠ¡å®Œæˆæƒ…å†µ

### å®ç°çš„æ¼‚ç§»æŒ‡æ ‡ï¼ˆ12ä¸ªï¼‰

#### 1ï¸âƒ£ åˆ†å¸ƒå‹æŒ‡æ ‡ï¼ˆ5ä¸ªï¼‰
| æŒ‡æ ‡ | æè¿° | é˜ˆå€¼ï¼ˆGREEN/YELLOWï¼‰ |
|------|------|---------------------|
| **PSI** | Population Stability Index | 0.1 / 0.25 |
| **JS divergence** | Jensen-Shannon æ•£åº¦ | 0.1 / 0.2 |
| **Bucket shift** | æ¡¶å æ¯”å˜åŒ– | 0.05 / 0.1 |
| **KS test** | Kolmogorov-Smirnov æ£€éªŒ | 0.1 / 0.2 |
| **Wasserstein** | Earth Mover's Distance | 0.1 / 0.2 |

**å…³é”®ç‰¹æ€§**ï¼š
- PSI å’Œ JS æ•£åº¦ç”¨äºæ£€æµ‹åˆ†æ¡¶åˆ†å¸ƒå˜åŒ–
- KS test æä¾›ç»Ÿè®¡æ˜¾è‘—æ€§ï¼ˆp-valueï¼‰
- Wasserstein è¡¡é‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦»

#### 2ï¸âƒ£ ç»Ÿè®¡å‹æŒ‡æ ‡ï¼ˆ7ä¸ªï¼‰
| æŒ‡æ ‡ | æè¿° | é˜ˆå€¼ |
|------|------|------|
| **Percentile shift** | åˆ†ä½æ•°å˜åŒ– | 0.02 / 0.05 |
| **Tail change** | å°¾éƒ¨å˜åŒ–ï¼ˆP5, P10ï¼‰ | 0.01 / 0.03 |
| **Absolute change** | ç»å¯¹å˜åŒ– | 0.01 / 0.02 |
| **Relative change** | ç›¸å¯¹å˜åŒ–ï¼ˆç™¾åˆ†æ¯”ï¼‰ | 0.1 / 0.2 |
| **Threshold breach** | é˜ˆå€¼çªç ´æ£€æµ‹ | åŠ¨æ€ |
| **Rate breach** | é¢‘ç‡çªç ´æ£€æµ‹ | åŠ¨æ€ |
| **Stability check** | ç¨³å®šæ€§æ£€æŸ¥ï¼ˆCVï¼‰ | 2.0 |

**å…³é”®ç‰¹æ€§**ï¼š
- æ”¯æŒ baseline + 2Ïƒ åŠ¨æ€é˜ˆå€¼
- å˜å¼‚ç³»æ•°ç”¨äºç¨³å®šæ€§æ£€æŸ¥
- é¢‘ç‡ç±»æŒ‡æ ‡ä¸“é—¨æ£€æµ‹å¼‚å¸¸æ¿€å¢

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### `analysis/drift_metrics.py`

æ ¸å¿ƒç±»ï¼š

#### `DriftMetricsCalculator`
- æ³¨å†Œäº†12ä¸ªæ¼‚ç§»æŒ‡æ ‡è®¡ç®—æ–¹æ³•
- ç»Ÿä¸€çš„ `calculate_metric()` æ¥å£
- è¿”å› valueã€p_valueã€details

#### `DriftMetricsEvaluator`
- å°è£… Calculator
- æä¾›é˜ˆå€¼åˆ¤æ–­é€»è¾‘ï¼ˆGREEN/YELLOW/REDï¼‰
- ç”Ÿæˆå¯è¯»çš„è¯„ä¼°æ¶ˆæ¯

#### `DriftMetricsResult`
- æ ‡å‡†åŒ–çš„ç»“æœæ•°æ®ç»“æ„
- åŒ…å«çŠ¶æ€ã€é˜ˆå€¼ã€è¯¦ç»†ä¿¡æ¯

---

## ğŸ¯ å…³é”®è®¾è®¡å†³ç­–

### 1. ç»Ÿä¸€æ¥å£
```python
result = evaluator.evaluate(
    metric_name="psi",
    baseline=baseline_data,
    current=current_data,
    config=config
)
```

### 2. åˆ†çº§é˜ˆå€¼
- **GREEN**: æ— æ˜¾è‘—æ¼‚ç§»
- **YELLOW**: è½»å¾®æ¼‚ç§»ï¼ˆè®°å½•+å‘Šè­¦ï¼‰
- **RED**: æ˜¾è‘—æ¼‚ç§»ï¼ˆè§¦å‘å†æ ‡å®šå€™é€‰ï¼‰

### 3. è¯¦ç»†ä¿¡æ¯è¿”å›
æ¯ä¸ªæŒ‡æ ‡éƒ½è¿”å› `details` å­—å…¸ï¼š
- åˆ†å¸ƒå‹ï¼šè¿”å›åˆ†æ¡¶å æ¯”å˜åŒ–
- ç»Ÿè®¡å‹ï¼šè¿”å›åŸºçº¿/å½“å‰å€¼å¯¹æ¯”
- æ£€æµ‹å‹ï¼šè¿”å›æ˜¯å¦çªç ´é˜ˆå€¼

### 4. å…¼å®¹æ€§å¤„ç†
- Wasserstein è·ç¦»ï¼šä¸ºæ—§ç‰ˆ scipy æä¾›ç®€åŒ–å®ç°
- é™¤é›¶ä¿æŠ¤ï¼šPSI/JS divergence ä¸­é¿å… log(0)
- ç©ºæ•°æ®å¤„ç†ï¼šå¤„ç†ç©ºæ•°ç»„æƒ…å†µ

---

## ğŸ“Š æµ‹è¯•ç»“æœ

```
=== SPL-6a-B: æ¼‚ç§»æŒ‡æ ‡è®¡ç®—æµ‹è¯• ===

Baseline: mean=0.0193, std=0.9787
Current: mean=0.1779, std=1.0967

æµ‹è¯• KS test:
  Value: 0.0870
  Status: GREEN
  Message: No significant drift detected (ks_test=0.0870)

æµ‹è¯• Wasserstein:
  Value: 0.1828
  Status: YELLOW
```

---

## ğŸš€ ä¸‹ä¸€æ­¥ï¼šSPL-6a-C

éœ€è¦è®¾å®šæ¼‚ç§»é˜ˆå€¼ä¸åˆ†çº§å“åº”ï¼š
1. åˆ›å»º `drift_thresholds.yaml` é…ç½®æ–‡ä»¶
2. å®šä¹‰å†æ ‡å®šè§¦å‘æ¡ä»¶ï¼ˆRED ä¸”è¿ç»­ N æ¬¡ï¼‰
3. å®ç°æ¼‚ç§»åˆ†çº§å“åº”ç­–ç•¥

---

**ç”Ÿæˆæ—¶é—´**: 2026-02-01
**SPL-6a è¿›åº¦**: 2/5 (40%) âœ…
